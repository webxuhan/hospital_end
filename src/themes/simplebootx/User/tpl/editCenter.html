<!-- 个人信息 -->
<div class="personal-information clearfix">
      <div class="informationHead">
        <span class="addInformation">{:L('PERSON_INFORMATION')}<i class="iconfont">&#xe755;</i></span>
        {:L('FULL_INFO')}
      </div>
</div>
<div class="informationContent">
  <form class="form-sysck">
  <div class="niceName  form-group"><label class="control-label" for="input-user_nicename">{:L('ZN_NAME')}:</label>
    <input type="text" id="input-user_nicename" placeholder="{:L('ZN_NAME')}" name="zn_name" value="{$staff.zn_name}">
  </div>
  <div class="niceName  form-group"><label class="control-label" for="input-user_nicename">{:L('EN_NAME')}:</label>
    <input type="text" id="input-user_nicename" placeholder="{:L('EN_NAME')}" name="en_name" value="{$staff.en_name}">
  </div>
  <div class="gender form-group"><label class="control-label" for="input-sex">{:L('SEX')}:</label>
    <php>
          $sexs=array("0"=>L('SEX_PROTECT'),"1"=>L('SEX_MALE'),"2"=>L('SEX_FEMALE'));
          </php>
        <select id="input-sex" name="sex">
          <foreach name="sexs" item="vo">
          <php>$sexselected = $key==$staff['sex']?"selected":'';</php>
            <option value="{$key}" {$sexselected}>{$vo}</option>
          </foreach>
        </select>
  </div>
  <div class="clearfix form-group">
    <span class="mobilePhone"><span>{:L('MOBILE')}:</span><input type="text" name="mobile" value="{$staff.mobile}"></span>
    <span class="fixPhone"><span>{:L('EXTENSION_NO')}:</span><input type="text" name="extension_no" value="{$staff.extension_no}"></span>
  </div>
  <div class="department form-group"><span>{:L('DEPARTMENT')}:</span>
    <select name="department_id" id="">
      <volist name="depts" id="dp">
      <option value="{$dp.department_id}" <if condition="$staff['department_id'] eq $dp['department_id']">selected="selected"</if>>{$dp.department_name}</option>
    </volist>
    </select>
  </div>
  <div class="niceName"><label class="control-label" for="input-user_nicename">{:L('SEAT_NO')}:</label>
    <input type="text" id="input-user_nicename" placeholder="" value="{$staff.seat_detail}" disabled>
  </div>
  <div class="niceName form-group"><label class="control-label" for="input-email">{:L('EMAIL')}:</label>
    <input type="text" name="email" id="input-email" placeholder="" value="{$staff.email}">
  </div>

  <button class="userinfo_save">{:L('SAVE')}</button>
  </form>
</div>
<script src="__PUBLIC__/js/common.js"></script>

<script src="__PUBLIC__/simpleboot/bootstrap/js/bootstrap.min.js"></script>
<script src="__PUBLIC__/simpleboot/bootstrap/css/bootstrapValidator.css" rel="stylesheet" type="text/css"></script>
<script src="__PUBLIC__/simpleboot/bootstrap/js/bootstrapValidator.js"></script>
<script src="__PUBLIC__/simpleboot/bootstrap/js/language/zh_CN.js"></script>
<script>

$(function() {
      $(".form-sysck").bootstrapValidator({
        message: '{:L("IS_NOT_VALID")}',
        feedbackIcons: {
            valid: 'glyphicon glyphicon-ok',
            invalid: 'glyphicon glyphicon-remove',
            validating: 'glyphicon glyphicon-refresh'
        },
        fields: {
            zn_name: {
                message: '{:L("IS_NOT_VALID")}',
                validators: {
                  notEmpty: {
                      message: '{:L("ZN_NAME_REQUIRED")}'
                  },
                  regexp: {
                      regexp: /^[\u4e00-\u9fa5]{1,33}$/,
                      message: '{:L("ZN_NAME_ERROR")}'
                  }
                }
            },
            en_name: {
                message: '{:L("IS_NOT_VALID")}',
                validators: {
                  notEmpty: {
                        message: '{:L("EN_NAME_REQUIRED")}'
                  },
                  regexp: {
                      regexp: /^[a-zA-Z]{1,99}$/,
                      message: '{:L("EN_NAME_ERROR")}'
                  }
                }
            },
            mobile: {
                validators: {
                  notEmpty: {
                      message: '{:L("MOBILE_REQUIRED")}'
                  },
                  regexp: {
                      regexp: /^1(3|4|5|7|8)\d{9}$/,
                      message: '{:L("MOBILE_ERROR")}'
                  }
                }
            },
            extension_no: {
                validators: {
                    regexp: {
                        regexp: /^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/,
                        message: '{:L("EXTENSION_NO_ERROR")}'
                    }
                }
            },
            email:{
                validators: {
                  notEmpty: {
                        message: '{:L("EMAIL_REQUIRED")}'
                    },
                    emailAddress: {
                        message: '{:L("EMAIL_ERROR")}'
                    },
                }
            },
        }
    });// end bootstrapValidator


    $('.userinfo_save').on('click', function() {
          var bootstrapValidator = $('.form-sysck').data('bootstrapValidator');
          if (bootstrapValidator) {
              // 修复记忆的组件不验证
              bootstrapValidator.validate();

              if (!bootstrapValidator.isValid()) {

                  return false;
              }else{
                $.ajax({
                  url:'{:U("Xing/editStaff")}',
                  method:'post',
                  dataType:'json',
                  data:$('form').serialize(),
                  success:function(data) {

                     if(data.status == 1) {
                          var n = noty({
                            text:"{:L('EDIT_SUCCESS')}",
                            type:"success",
                            layout:"center"
                          });
                          $(".main-content").load("{:U('Xing/center')}");
                     }else{

                        noty({
                            text:"{:L('EDIT_FAILED')}",
                            type:"error",
                            layout:"center"
                          });
                     }
                  }

                });
              }

          }
          
      }); // end click function 
});
  

  

</script>